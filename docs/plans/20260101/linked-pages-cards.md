# å®Ÿè£…è¨ˆç”»æ›¸: Linked Pages Cardsï¼ˆãƒªãƒ³ã‚¯ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºï¼‰

## æ¦‚è¦

| é …ç›®       | å†…å®¹                                                                                       |
| :--------- | :----------------------------------------------------------------------------------------- |
| **æ©Ÿèƒ½å** | Linked Pages Cardsï¼ˆãƒªãƒ³ã‚¯ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºï¼‰                                                     |
| **ç›®çš„**   | ãƒšãƒ¼ã‚¸ä¸‹éƒ¨ã«ã€ãã®ãƒšãƒ¼ã‚¸ã‹ã‚‰ãƒªãƒ³ã‚¯ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ã¨ã€é€†ã«ãƒªãƒ³ã‚¯ã•ã‚Œã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ã‚’ã‚«ãƒ¼ãƒ‰è¡¨ç¤º |
| **å„ªå…ˆåº¦** | ğŸŸ¡ æ¨å¥¨ï¼ˆPhase 4 ã®ä¿ç•™æ©Ÿèƒ½ï¼‰                                                              |
| **ä¾å­˜**   | WikiLink æ©Ÿèƒ½ï¼ˆâœ… å®Ÿè£…æ¸ˆã¿ï¼‰ã€links ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆâœ… å®Ÿè£…æ¸ˆã¿ï¼‰                                |

---

## æ©Ÿèƒ½è¦ä»¶

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒ¼ã‚¸ã‚’é–‹ãã¨ã€ã‚¨ãƒ‡ã‚£ã‚¿ä¸‹éƒ¨ã«ãƒªãƒ³ã‚¯é–¢é€£ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹
2. ä»¥ä¸‹ã® 3 ç¨®é¡ã®ãƒªãƒ³ã‚¯æƒ…å ±ãŒã‚«ãƒ¼ãƒ‰å½¢å¼ã§è¡¨ç¤ºã•ã‚Œã‚‹ï¼š
   - **Outgoing Linksï¼ˆãƒªãƒ³ã‚¯å…ˆï¼‰**: ã“ã®ãƒšãƒ¼ã‚¸ã‹ã‚‰ `[[ãƒªãƒ³ã‚¯]]` ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸
   - **Backlinksï¼ˆè¢«ãƒªãƒ³ã‚¯ï¼‰**: ã“ã®ãƒšãƒ¼ã‚¸ã‚’ `[[ãƒªãƒ³ã‚¯]]` ã—ã¦ã„ã‚‹ä»–ã®ãƒšãƒ¼ã‚¸
   - **2-hop Linksï¼ˆ2 éšå±¤å…ˆï¼‰**: ãƒªãƒ³ã‚¯å…ˆãƒšãƒ¼ã‚¸ãŒã•ã‚‰ã«ãƒªãƒ³ã‚¯ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
3. ã‚«ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ãã®ãƒšãƒ¼ã‚¸ã«é·ç§»ã™ã‚‹
4. ãƒªãƒ³ã‚¯ãŒãªã„å ´åˆã¯ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯è¡¨ç¤ºã•ã‚Œãªã„

### ãƒªãƒ³ã‚¯è¡¨ç¤ºä»•æ§˜

| é …ç›®                 | å†…å®¹                                                             |
| :------------------- | :--------------------------------------------------------------- |
| **Outgoing Links**   | ãƒšãƒ¼ã‚¸å†…ã® WikiLink ã‹ã‚‰æŠ½å‡ºã€‚å­˜åœ¨ã™ã‚‹ãƒšãƒ¼ã‚¸ã®ã¿è¡¨ç¤º             |
| **Backlinks**        | links ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ target_id ã§ã‚¯ã‚¨ãƒª                            |
| **2-hop Links**      | Outgoing Links ã®ãƒšãƒ¼ã‚¸ãŒæŒã¤ Outgoing Linksï¼ˆé‡è¤‡æ’é™¤ï¼‰         |
| **ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºå†…å®¹**   | ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«ã€æœ¬æ–‡ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ50 æ–‡å­—ï¼‰ã€æ›´æ–°æ—¥æ™‚              |
| **è¡¨ç¤ºä»¶æ•°**         | å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³æœ€å¤§ 6 ä»¶ï¼ˆã€Œã‚‚ã£ã¨è¦‹ã‚‹ã€ã§å±•é–‹ï¼‰                    |
| **Ghost Links è¡¨ç¤º** | å­˜åœ¨ã—ãªã„ãƒªãƒ³ã‚¯å…ˆã‚‚ç‚¹ç·šã‚¹ã‚¿ã‚¤ãƒ«ã§è¡¨ç¤ºï¼ˆã‚¯ãƒªãƒƒã‚¯ã§ä½œæˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰|

---

## UI è¨­è¨ˆ

### ãƒšãƒ¼ã‚¸ä¸‹éƒ¨ã®ãƒªãƒ³ã‚¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«                                    ç·¨é›†ä¸­...â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  [ã‚¨ãƒ‡ã‚£ã‚¿æœ¬æ–‡]                                             â”‚
â”‚  æ©Ÿæ¢°å­¦ç¿’ã¨ã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãŒãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å­¦ç¿’ã—...             â”‚
â”‚  è©³ã—ãã¯ [[ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯]] ã‚’å‚ç…§ã€‚               â”‚
â”‚  [[æ·±å±¤å­¦ç¿’]] ã‚‚é–¢é€£æ¦‚å¿µã§ã™ã€‚                              â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ”— ãƒªãƒ³ã‚¯å…ˆ (2)                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆ â”‚ â”‚ æ·±å±¤å­¦ç¿’         â”‚                  â”‚
â”‚  â”‚ ãƒ¯ãƒ¼ã‚¯           â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚                  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚ â”‚ æ©Ÿæ¢°å­¦ç¿’ã®ä¸€ç¨®ã§ â”‚                  â”‚
â”‚  â”‚ äººå·¥çŸ¥èƒ½ã®åŸºç›¤æŠ€ â”‚ â”‚ ã‚ã‚‹æ·±å±¤å­¦ç¿’ã¯...â”‚                  â”‚
â”‚  â”‚ è¡“ã§ã‚ã‚Š...      â”‚ â”‚ 3æ—¥å‰            â”‚                  â”‚
â”‚  â”‚ 1é€±é–“å‰          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚                                                             â”‚
â”‚  â†©ï¸ è¢«ãƒªãƒ³ã‚¯ (3)                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ AIå…¥é–€           â”‚ â”‚ ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ â”‚ â”‚ è‡ªå‹•é‹è»¢æŠ€è¡“ â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚ â”‚ å…¥é–€             â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚  â”‚ AIã®åŸºç¤çŸ¥è­˜ã‚’   â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚ â”‚ è‡ªå‹•é‹è»¢ã«å¿… â”‚ â”‚
â”‚  â”‚ ã¾ã¨ã‚ãŸ...      â”‚ â”‚ ãƒ‡ãƒ¼ã‚¿åˆ†æã®åŸºç¤ â”‚ â”‚ è¦ãªæŠ€è¡“...  â”‚ â”‚
â”‚  â”‚ æ˜¨æ—¥             â”‚ â”‚ ã‚’å­¦ã¶...        â”‚ â”‚ 2é€±é–“å‰      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ 3æ—¥å‰            â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                             â”‚
â”‚  ğŸŒ 2éšå±¤å…ˆ (4)                       â–¶ ã‚‚ã£ã¨è¦‹ã‚‹          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” ...              â”‚
â”‚  â”‚ ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³   â”‚ â”‚ æ´»æ€§åŒ–é–¢æ•°       â”‚                  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“„ ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«    â”‚  â† ã‚¢ã‚¤ã‚³ãƒ³ + ã‚¿ã‚¤ãƒˆãƒ«
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â† åŒºåˆ‡ã‚Šç·š
â”‚ æœ¬æ–‡ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚­ â”‚  â† æœ€å¤§2è¡Œã€50æ–‡å­—
â”‚ ã‚¹ãƒˆãŒã“ã“ã«è¡¨ç¤º...  â”‚
â”‚                      â”‚
â”‚ ğŸ• 3æ—¥å‰             â”‚  â† æ›´æ–°æ—¥æ™‚ï¼ˆç›¸å¯¾è¡¨è¨˜ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ghost Link ã‚«ãƒ¼ãƒ‰ï¼ˆå­˜åœ¨ã—ãªã„ãƒšãƒ¼ã‚¸ï¼‰

```
â”Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”
â”‚ ğŸ“ æœªä½œæˆã®ãƒªãƒ³ã‚¯    â”‚  â† ç‚¹ç·šãƒœãƒ¼ãƒ€ãƒ¼
â”‚ â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œ â”‚
â”‚                      â”‚
â”‚ ã‚¯ãƒªãƒƒã‚¯ã—ã¦         â”‚
â”‚ ãƒšãƒ¼ã‚¸ã‚’ä½œæˆ         â”‚
â”‚                      â”‚
â””â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”˜
```

---

## æŠ€è¡“è¨­è¨ˆ

### ãƒ‡ãƒ¼ã‚¿å–å¾— Hook

```typescript
// hooks/useLinkedPages.ts

export interface LinkedPagesData {
  outgoingLinks: PageCard[];     // ã“ã®ãƒšãƒ¼ã‚¸ã‹ã‚‰ãƒªãƒ³ã‚¯ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸
  backlinks: PageCard[];         // ã“ã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ³ã‚¯ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸
  twoHopLinks: PageCard[];       // 2éšå±¤å…ˆã®ãƒšãƒ¼ã‚¸
  ghostLinks: string[];          // å­˜åœ¨ã—ãªã„ãƒªãƒ³ã‚¯å…ˆ
}

export interface PageCard {
  id: string;
  title: string;
  preview: string;              // æœ¬æ–‡ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ50æ–‡å­—ï¼‰
  updatedAt: number;
  sourceUrl?: string;           // Webã‚¯ãƒªãƒƒãƒ—ã®å ´åˆ
}

export function useLinkedPages(pageId: string) {
  const { getRepository, userId, isLoaded } = useRepository();
  const { data: currentPage } = usePage(pageId);

  return useQuery({
    queryKey: [...pageKeys.all, "linkedPages", userId, pageId],
    queryFn: async (): Promise<LinkedPagesData> => {
      if (!currentPage) {
        return { outgoingLinks: [], backlinks: [], twoHopLinks: [], ghostLinks: [] };
      }

      const repo = await getRepository();

      // 1. ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã‹ã‚‰WikiLinkã‚’æŠ½å‡º
      const wikiLinks = extractWikiLinksFromContent(currentPage.content);
      const linkTitles = getUniqueWikiLinkTitles(wikiLinks);

      // 2. å…¨ãƒšãƒ¼ã‚¸ã‚’å–å¾—ã—ã¦ãƒãƒƒãƒ”ãƒ³ã‚°
      const allPages = await repo.getPages(userId);
      const pageByTitle = new Map(
        allPages.map(p => [p.title.toLowerCase().trim(), p])
      );
      const pageById = new Map(allPages.map(p => [p.id, p]));

      // 3. Outgoing Linksï¼ˆå­˜åœ¨ã™ã‚‹ãƒšãƒ¼ã‚¸ã®ã¿ï¼‰
      const outgoingLinks: PageCard[] = [];
      const ghostLinks: string[] = [];

      for (const title of linkTitles) {
        const targetPage = pageByTitle.get(title.toLowerCase().trim());
        if (targetPage && targetPage.id !== pageId) {
          outgoingLinks.push({
            id: targetPage.id,
            title: targetPage.title,
            preview: getContentPreview(targetPage.content, 50),
            updatedAt: targetPage.updatedAt,
            sourceUrl: targetPage.sourceUrl,
          });
        } else if (!targetPage) {
          ghostLinks.push(title);
        }
      }

      // 4. Backlinksï¼ˆlinksãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å–å¾—ï¼‰
      const backlinkIds = await repo.getBacklinks(pageId);
      const backlinks: PageCard[] = backlinkIds
        .map(id => pageById.get(id))
        .filter((p): p is Page => p !== undefined && !p.isDeleted)
        .map(p => ({
          id: p.id,
          title: p.title,
          preview: getContentPreview(p.content, 50),
          updatedAt: p.updatedAt,
          sourceUrl: p.sourceUrl,
        }));

      // 5. 2-hop Linksï¼ˆOutgoing Linksã®ãƒšãƒ¼ã‚¸ãŒæŒã¤Outgoing Linksï¼‰
      const twoHopSet = new Set<string>();
      const twoHopLinks: PageCard[] = [];

      for (const outgoing of outgoingLinks) {
        const outgoingPage = pageById.get(outgoing.id);
        if (!outgoingPage) continue;

        const secondaryLinks = extractWikiLinksFromContent(outgoingPage.content);
        for (const link of secondaryLinks) {
          const targetPage = pageByTitle.get(link.title.toLowerCase().trim());
          if (
            targetPage &&
            targetPage.id !== pageId &&
            !twoHopSet.has(targetPage.id) &&
            !outgoingLinks.some(o => o.id === targetPage.id)
          ) {
            twoHopSet.add(targetPage.id);
            twoHopLinks.push({
              id: targetPage.id,
              title: targetPage.title,
              preview: getContentPreview(targetPage.content, 50),
              updatedAt: targetPage.updatedAt,
              sourceUrl: targetPage.sourceUrl,
            });
          }
        }
      }

      return {
        outgoingLinks: outgoingLinks.slice(0, 10),
        backlinks: backlinks.slice(0, 10),
        twoHopLinks: twoHopLinks.slice(0, 10),
        ghostLinks: ghostLinks.slice(0, 5),
      };
    },
    enabled: isLoaded && !!pageId && !!currentPage,
    staleTime: 1000 * 30, // 30ç§’
  });
}
```

### Repository ã¸ã®è¿½åŠ 

```typescript
// lib/pageRepository.ts ã¨ localPageRepository.ts ã«è¿½åŠ 

/**
 * Get pages that link to the specified page (backlinks)
 */
async getBacklinks(targetPageId: string): Promise<string[]> {
  const result = await this.client.execute({
    sql: `SELECT source_id FROM links WHERE target_id = ?`,
    args: [targetPageId],
  });

  return result.rows.map((row) => row.source_id as string);
}

/**
 * Get outgoing links from a page
 */
async getOutgoingLinks(sourcePageId: string): Promise<string[]> {
  const result = await this.client.execute({
    sql: `SELECT target_id FROM links WHERE source_id = ?`,
    args: [sourcePageId],
  });

  return result.rows.map((row) => row.target_id as string);
}
```

### UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// components/page/LinkedPagesSection.tsx

interface LinkedPagesSectionProps {
  pageId: string;
}

export function LinkedPagesSection({ pageId }: LinkedPagesSectionProps) {
  const { data, isLoading } = useLinkedPages(pageId);
  const navigate = useNavigate();

  if (isLoading) {
    return <LinkedPagesSkeleton />;
  }

  if (!data) return null;

  const { outgoingLinks, backlinks, twoHopLinks, ghostLinks } = data;
  const hasAnyLinks =
    outgoingLinks.length > 0 ||
    backlinks.length > 0 ||
    twoHopLinks.length > 0 ||
    ghostLinks.length > 0;

  if (!hasAnyLinks) return null;

  return (
    <div className="border-t pt-6 mt-6 space-y-6">
      {/* Outgoing Links */}
      {outgoingLinks.length > 0 && (
        <LinkSection
          title="ãƒªãƒ³ã‚¯å…ˆ"
          icon={<Link2 className="h-4 w-4" />}
          pages={outgoingLinks}
          onPageClick={(id) => navigate(`/page/${id}`)}
        />
      )}

      {/* Ghost Links */}
      {ghostLinks.length > 0 && (
        <GhostLinkSection
          title="æœªä½œæˆã®ãƒªãƒ³ã‚¯"
          links={ghostLinks}
        />
      )}

      {/* Backlinks */}
      {backlinks.length > 0 && (
        <LinkSection
          title="è¢«ãƒªãƒ³ã‚¯"
          icon={<ArrowLeft className="h-4 w-4" />}
          pages={backlinks}
          onPageClick={(id) => navigate(`/page/${id}`)}
        />
      )}

      {/* 2-hop Links */}
      {twoHopLinks.length > 0 && (
        <Collapsible>
          <CollapsibleTrigger className="flex items-center gap-2">
            <Globe className="h-4 w-4" />
            <span>2éšå±¤å…ˆ ({twoHopLinks.length})</span>
            <ChevronDown className="h-4 w-4" />
          </CollapsibleTrigger>
          <CollapsibleContent>
            <LinkSection
              pages={twoHopLinks}
              onPageClick={(id) => navigate(`/page/${id}`)}
            />
          </CollapsibleContent>
        </Collapsible>
      )}
    </div>
  );
}
```

### ãƒšãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// components/page/PageLinkCard.tsx

interface PageLinkCardProps {
  page: PageCard;
  onClick: () => void;
}

export function PageLinkCard({ page, onClick }: PageLinkCardProps) {
  return (
    <Card
      className="cursor-pointer hover:bg-accent transition-colors"
      onClick={onClick}
    >
      <CardHeader className="p-3 pb-1">
        <CardTitle className="text-sm font-medium flex items-center gap-2">
          {page.sourceUrl ? (
            <LinkIcon className="h-3 w-3 text-muted-foreground" />
          ) : (
            <FileText className="h-3 w-3 text-muted-foreground" />
          )}
          <span className="truncate">{page.title || "ç„¡é¡Œã®ãƒšãƒ¼ã‚¸"}</span>
        </CardTitle>
      </CardHeader>
      <CardContent className="p-3 pt-0">
        <p className="text-xs text-muted-foreground line-clamp-2">
          {page.preview || "å†…å®¹ãŒã‚ã‚Šã¾ã›ã‚“"}
        </p>
        <p className="text-xs text-muted-foreground mt-2">
          {formatTimeAgo(page.updatedAt)}
        </p>
      </CardContent>
    </Card>
  );
}
```

---

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
src/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ page/
â”‚       â”œâ”€â”€ LinkedPagesSection.tsx    # ãƒ¡ã‚¤ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆæ–°è¦ï¼‰
â”‚       â”œâ”€â”€ PageLinkCard.tsx          # ãƒšãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰ï¼ˆæ–°è¦ï¼‰
â”‚       â”œâ”€â”€ GhostLinkCard.tsx         # Ghost Link ã‚«ãƒ¼ãƒ‰ï¼ˆæ–°è¦ï¼‰
â”‚       â””â”€â”€ LinkSection.tsx           # ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆæ–°è¦ï¼‰
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useLinkedPages.ts             # ãƒªãƒ³ã‚¯å–å¾—ãƒ•ãƒƒã‚¯ï¼ˆæ–°è¦ï¼‰
â””â”€â”€ lib/
    â”œâ”€â”€ pageRepository.ts             # getBacklinks è¿½åŠ ï¼ˆä¿®æ­£ï¼‰
    â””â”€â”€ localPageRepository.ts        # getBacklinks è¿½åŠ ï¼ˆä¿®æ­£ï¼‰
```

---

## å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

| Step | å†…å®¹                                               | è¦‹ç©ã‚‚ã‚Š |
| :--- | :------------------------------------------------- | :------- |
| 1    | Repository ã« getBacklinks ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ             | 1 æ™‚é–“   |
| 2    | useLinkedPages ãƒ•ãƒƒã‚¯ã®å®Ÿè£…                        | 2 æ™‚é–“   |
| 3    | PageLinkCard ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…                  | 1 æ™‚é–“   |
| 4    | GhostLinkCard ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…                 | 30 åˆ†    |
| 5    | LinkSection ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…                   | 1 æ™‚é–“   |
| 6    | LinkedPagesSection ã®å®Ÿè£…                          | 1.5 æ™‚é–“ |
| 7    | 2-hop Links ã®å–å¾—ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…                     | 1.5 æ™‚é–“ |
| 8    | PageEditorView ã¸ã®çµ±åˆ                            | 30 åˆ†    |
| 9    | ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã¨ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°                     | 1 æ™‚é–“   |
| 10   | ãƒ†ã‚¹ãƒˆã¨èª¿æ•´                                       | 1 æ™‚é–“   |

**åˆè¨ˆè¦‹ç©ã‚‚ã‚Š: ç´„ 11 æ™‚é–“**

---

## è€ƒæ…®äº‹é …

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

| æ‡¸å¿µäº‹é …                    | å¯¾ç­–                                                     |
| :-------------------------- | :------------------------------------------------------- |
| å¤§é‡ã®ãƒšãƒ¼ã‚¸ãŒã‚ã‚‹å ´åˆ      | å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³æœ€å¤§ 10 ä»¶ã«åˆ¶é™ã€staleTime ã‚’è¨­å®š           |
| 2-hop Links ã®è¨ˆç®—ã‚³ã‚¹ãƒˆ    | é…å»¶ãƒ­ãƒ¼ãƒ‰ï¼ˆCollapsible ã§å±•é–‹æ™‚ã«å–å¾—ï¼‰                 |
| ãƒªãƒ³ã‚¯å¤‰æ›´æ™‚ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥    | ãƒšãƒ¼ã‚¸ä¿å­˜æ™‚ã«é–¢é€£ã‚¯ã‚¨ãƒªã‚’ invalidate                    |

### ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹

| ã‚±ãƒ¼ã‚¹                     | å¯¾å¿œ                                           |
| :------------------------- | :--------------------------------------------- |
| è‡ªåˆ†è‡ªèº«ã¸ã®ãƒªãƒ³ã‚¯         | è¡¨ç¤ºã‹ã‚‰é™¤å¤–                                   |
| å‰Šé™¤ã•ã‚ŒãŸãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ | Ghost Link ã¨ã—ã¦æ‰±ã†                          |
| å¾ªç’°ãƒªãƒ³ã‚¯                 | é‡è¤‡æ’é™¤ã§å¯¾å¿œ                                 |
| ãƒªãƒ³ã‚¯ãŒå¤§é‡ã«ã‚ã‚‹å ´åˆ     | ã€Œã‚‚ã£ã¨è¦‹ã‚‹ã€ã§å±•é–‹è¡¨ç¤º                       |

---

## å°†æ¥ã®æ‹¡å¼µ

1. **ã‚°ãƒ©ãƒ•ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒªãƒ³ã‚¯é–¢ä¿‚ã‚’ã‚°ãƒ©ãƒ•ã§å¯è¦–åŒ–
2. **ãƒªãƒ³ã‚¯å¼·åº¦è¡¨ç¤º**: åŒæ–¹å‘ãƒªãƒ³ã‚¯ã‚’å¼·èª¿è¡¨ç¤º
3. **ãƒªãƒ³ã‚¯ææ¡ˆ**: AIãŒãƒªãƒ³ã‚¯å€™è£œã‚’ææ¡ˆ
4. **ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**: ãƒªãƒ³ã‚¯å…ƒã®æ–‡è„ˆï¼ˆå‰å¾Œã®æ–‡ç« ï¼‰ã‚’è¡¨ç¤º

---

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [PRD: 2.4 ãƒªãƒ³ã‚¯æ©Ÿèƒ½ - Backlinks & 2-hop Links](../PRD.md#24-ãƒªãƒ³ã‚¯æ©Ÿèƒ½)
- [PRD: 2.2 Ghost Link System](../PRD.md#ghost-link-system)
